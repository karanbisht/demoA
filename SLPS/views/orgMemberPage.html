<!-- replace 7FBF4D 5992CB color:rgb(127,191,77) with e7613e -->
<div data-role="view" id="memberPageGroupList" data-id="innerActivity" data-layout="innerPages" class="actScrollView" data-model="app.groupDetail" data-show="app.groupDetail.showGroup" data-use-native-scrolling="true">
    <div data-role="header">
        <div data-role="navbar">
            Select Group
            <a style="background:transparent; border:none;" data-icon="camera" data-align="left" data-role="button" data-click="app.groupDetail.backToOrgDetail"></a>
            <a style="width: 3.5em;height:3em;margin-top:2px; border: 0 none;  background-position: 0 50%;background-color: transparent;" data-align="right" data-role="button" href="#popover-orgMemberGroup" data-rel="popover">
                <img src="styles/images/nav.png" style="background-position: .65em 50%;width:100%;height:90%"/>
            </a>
        </div>
    </div>
    <div data-role="popover" id="popover-orgMemberGroup" data-popup='{"width": "180"}' style="position:relative;margin-right:-10px;margin-top:-14px;border-radius:0px 0px 3px 3px;z-index:100;box-shadow: 0px 4px 10px 1px #D1D1D1;">
        <div data-role="view">
            <ul data-role="listview" style="margin:0px;background-color:#ffffff;">
                <a style="width:100%;background:transparent;margin:0px 0px -3px 0px;border-radius:0px;padding:0px;border:none;" data-role="button" data-click="app.groupDetail.addMemberToGroup">
                    <label style="float:left;padding:10px;">Add Member</label>
                </a>
            </ul>
        </div>
    </div>
    <div>
        <span id="memberGroup-listview" data-style="inset" data-role="listview" data-template="memberGroupTemplate"  data-bind="source:groupListData"></span>
    </div>
</div>

<div data-role="view" id="groupMemberShow" data-id="innerActivity" data-layout="innerPages"  class="actScrollView"  data-model="app.groupDetail" data-show ="app.groupDetail.orgMemberShow" data-use-native-scrolling="true">
    <div data-role="header">
        <div data-role="navbar">
            <span id="adminMembHeader" class="inner_navBarClass">Members</span>
            <a style="background:transparent; border:none;" data-icon="camera" data-align="left" data-role="button" data-click="app.groupDetail.backToOrgGrpDetail"></a>
            <a style="width: 3.5em;height:3em;margin-top:2px; border: 0 none;  background-position: 0 50%;background-color: transparent;" data-align="right" data-role="button" href="#popover-orgMember" data-rel="popover">
                <img src="styles/images/nav.png" style="background-position: .65em 50%;width:100%;height:90%"/>
            </a>
        </div>
    </div>
    <div>
        <ul id="groupMember-listview" data-role="listview" data-template="groupMemberTemplate" data-bind="source: activities" style="margin:10px;border:none;"></ul>
    </div>
    <div data-role="popover" id="popover-orgMember" data-popup='{"width": "180"}' style="position:relative;margin-right:-10px;margin-top:-14px;border-radius:0px 0px 3px 3px;z-index:100;box-shadow: 0px 4px 10px 1px #D1D1D1;">
        <div data-role="view">
            <ul data-role="listview" style="margin:0px;background-color:#ffffff;">
                <a style="width:100%;background:transparent;margin:0px 0px -3px 0px;border-radius:0px;padding:0px;border:none;" data-role="button" data-click="app.groupDetail.addMemberToGroup">
                    <label style="float:left;padding:10px;">Add Member</label>
                </a>
                <a style="width:100%;background:transparent;margin:0px 0px -3px 0px;border-radius:0px;border:none;padding:0px;" data-role="button" data-click="app.groupDetail.removeMemberFromGroup">
                    <label style="float:left;padding:10px;">Remove Member</label>
                </a>
            </ul>
        </div>
    </div>
</div>

<div data-role="view" id="removeMemberFromGroup" data-id="innerActivity" data-layout="innerPages" class="activities-view" data-model="app.groupDetail"  data-show="app.groupDetail.showGroupToDelete" data-use-native-scrolling="true">
    <div data-role="header">
        <div data-role="navbar">
            Delete Members
            <a style="background:transparent; border:none;" data-icon="camera" data-align="left" data-role="backbutton"></a>
            <a style="width: 3.5em;height:3em;margin-top:2px; border: 0 none;  background-position: 0 50%;background-color: transparent;" data-align="right" data-role="button" data-click="app.groupDetail.removeMemberClick">
                <img src="styles/images/delete.png" style="background-position: .65em 50%;width:100%;height:90%"/>
            </a>
        </div>
    </div>
    <ul data-role="listview" data-type="group" id="deleteMemberData" data-bind="source: groupDetail" style="margin:10px;"></ul>
</div>

<script type="text/x-kendo-template" id="memberGroupTemplate">
    #if (groupID!==0 && groupID!=='0') {#
        <div data-role="touch" data-bind="events: { tap: memberGroupSelected }" class="cf-clickEffect">
            <div class="group-img-show"></div>
            <div class="activity-content">
                <h2 id="" class="person-name">${groupName}</h2>
                <span class="km-icon km-details" style="float:right;margin-top:-10px;"></span>
                <a id="activityTemplateMessage" class="user-share-txt">${groupDesc}</a>
            </div>
        </div>
    #}else {#
        <div class="cf">
            <div class="group-img-show"></div>
            <div class="activity-content">
                <h2 id="" class="person-name">${groupName}</h2>
                <a id="activityTemplateMessage" class="user-share-txt">${groupDesc}</a>
            </div>
        </div>
    #}#   
</script>

<script type="text/x-kendo-template" id="groupMemberTemplate">
    #if (orgID!=='0') {#
    <div class="cf-clickEffect" data-role="touch" data-bind="events: { tap: clickOnOrgMember }">
        #if (photo!=="" && photo!=='null') {#
            <img src=${photo} class="user-avatar-img" onerror="this.onerror=null;this.src='styles/images/avatar1.png';"/>
        #}else {#
            <div class="user-avatar-img-show"></div>
        #}#
        <div class="activity-content" >
            <h2 id="" class="person-name">${first_name} ${last_name}</h2>
            <span class="km-icon km-details" style="float:right;margin-top:-10px;"></span>
            <a id="activityTemplateMessage" class="user-share-txt">${mobile}</a>
        </div>
    </div>
    #}else {#
        <div class="cf" style="margin:10px;">
            <div class="user-avatar-img-show"></div>
            <div class="no-activity-content">
                <a id="activityTemplateMessage" class="user-share-txt">${email}</a>
            </div>
        </div>        
    #}#
</script>

<script type="text/x-kendo-template" id="Member-Delete-template"> 
    #if (orgID!=='0') {#  
    <label class="km-listview-label">
        <input type="checkbox" value="${customerID}" class="km-widget km-icon km-check" data-bind="checked:check" />
        #:first_name#
        #:last_name#
    </label>        
    #}else {#    
        <div class="cf" style="margin:10px;">
            <div class="user-avatar-img-show"></div>
            <div class="no-activity-content">
                <a id="activityTemplateMessage" class="user-share-txt">${email}</a>
            </div>
        </div>        
    #}

    #
</script>

<div data-role="view" id="editMemberInAdmin" data-layout="default" class="activities-view" data-model="app.groupDetail" data-show="app.groupDetail.editMemberShow" data-use-native-scrolling="true">
    <div data-role="header">
        <div data-role="navbar">
            Edit Member
            <a style="background:transparent; border:none;" data-icon="camera" data-align="left" data-role="backbutton"></a>
            <a style="background:transparent; border:none;" data-icon="printer" data-align="right" data-role="button" data-click="app.callAdminOrganisationList"></a>
        </div>
    </div>
    <div id="editOrgMemberContent">
        <div style="vertical-align:middle; text-align:left;border:none;margin-top:10px;">
            <a style="background:transparent; border:none;margin:0px;" data-role="button" data-rel="actionsheet" data-align="center" href="#adminMemberprofilePicUpload" >
                <img id="editMemberPhoto" src="" height="100px" width="100px" style="position:relative;border-radius:3px;background-size: cover;background-position: center center; background-repeat: no-repeat;" onerror="this.onerror = null;this.src = 'styles/images/profile-img1.png';"/>
                <div class="profilePicBack">
                    <span style="z-index:1;text-align:center;">Change</span>
                </div>
            </a>
        </div>
        <form>
            <ul data-role="listview" data-style="inset">
                <li class="username" style="padding-left:0px;">
                    <input type="text" id="editFirstNameAdmin" placeholder="First Name" style="padding-left:0px;margin-left:0px;"/>
                </li>
                <li class="password" style="padding-left:0px;">
                    <input type="text"  id="editLastNameAdmin" placeholder="Last Name" style="padding-left:0px;margin-left:0px;"/>
                </li>
                <li class="password" style="padding-left:0px;">
                    <input type="email" id="editEmailAdmin" placeholder="Email" style="padding-left:0px;margin-left:0px;"/>
                </li>
                <li class="password" style="padding-left:0px;">
                    <input type="number" pattern="[0-9]*" step="0.01" id="staticMobile" placeholder="Mobile Number" style="padding-left:0px;margin-left:0px;"/>
                </li>
            </ul>
            <a style="padding-left:10px;color:#e7613e;" data-role="touch" data-bind="events: { tap: addMoreMobileNoPage }">Add More Number</a>
            <div id="showAlternateList" style="padding-left:10px;padding-top:10px;">
                Alternate Number
                <ul  id="alternateMobileList" data-role="listview" data-style="inset" style="padding-left:0px;margin-left:0px;"></ul>
            </div>
        </form>
        <label style="margin:10px;color:#e7613e;">
            <span>Member Added to Group</span>
            <select id="groupInEditMember"  multiple style="margin-left:10px;width:94.5%;"></select>
        </label>
        <ul data-role="actionsheet" id="adminMemberprofilePicUpload">
            <li class="km-actionsheet-title">Choose an action</li>
            <li>
                <a href="#" data-role="button" data-bind="click: takeMemberProfilePhoto" style="text-align:left;">
                    <span class="act_photo"></span><span style="margin-top:-20px;">Photo</span>
                </a>
            </li>
            <li>
                <a href="#" data-role="button" data-bind="click: selectMemberProfilePhoto" style="text-align:left;">
                    <span class="act_gallery"></span><span style="margin-top:-20px;">Gallery</span>
                </a>
            </li>
        </ul>
        <li id="registrationNextR" class="defineSaveButton" data-role="touch" data-bind="events: { tap: editProfileFunc }">
            Save
        </li>
    </div>

</div>

<script>
    function removeAlternateNo(num) {
        var li_Count = num + 1;        
        var arrayval = JSON.parse(localStorage["ALTER_ARRAY"]);
    
        var orgId = arrayval[num].org_id;
        var custNo = arrayval[num].customerId;
        var alterId = arrayval[num].id;
        
        var dataSourceDeleteAlternateNo = new kendo.data.DataSource({
    
                                                                        transport: {
                read: {
                                                                                    url: app.serverUrl() + "customer/removeAlternate/" + orgId + "/" + custNo + "/" + alterId,
                                                                                    type:"POST",
                                                                                    dataType: "json" // "jsonp" is required for cross-domain requests; use "json" for same-domain requests
                                                                                }
            },
                                                                        schema: {
                data: function(data) {
                    return [data];
                }
            },
                                                                        error: function (e) {
                                                                            if (!app.checkConnection()) {
                                                                                if (!app.checkSimulator()) {
                                                                                    window.plugins.toast.showShortBottom(app.INTERNET_ERROR);
                                                                                }else {
                                                                                    app.showAlert(app.INTERNET_ERROR , 'Offline'); 
                                                                                } 
                                                                            }else {
                                                                                if (!app.checkSimulator()) {
                                                                                    window.plugins.toast.showShortBottom(app.ERROR_MESSAGE);
                                                                                }else {
                                                                                    app.showAlert(app.ERROR_MESSAGE , 'Offline'); 
                                                                                }
                                                                                app.analyticsService.viewModel.trackException(e, 'Api Call , Unable to get response' + JSON.stringify(e));
                                                                            } 
                                                                            app.analyticsService.viewModel.trackException(e, 'Api Call , Unable to get response from API fetching Organization Member in Admin Panel' + JSON.stringify(e));
                                                                        }               
                                                                    });  
    
        dataSourceDeleteAlternateNo.fetch(function() {
            var loginDataView = dataSourceDeleteAlternateNo.data();
            $.each(loginDataView, function(i, loginData) {
                if (loginData.status[0].Msg==='Success') {
                    $("#editMobileLi" + li_Count).empty();
                    $("#editMobileLi" + li_Count).css("border", "none");
    
                    if (!app.checkSimulator()) {
                        window.plugins.toast.showShortBottom('Alternate Number Removed Successfully.');
                    }else {
                        app.showAlert("Alternate Number Removed Successfully.", "Notification"); 
                    }                            
                }else {
                    app.showAlert(loginData.status[0].Msg , 'Notification'); 
                }
            });
        });
    }
</script>

<div data-role="view" id="addAlternateNumber" data-layout="default" class="activities-view" data-model="app.groupDetail"
     data-show="app.groupDetail.addAlternateNo">

    <div data-role="header">
        <div data-role="navbar">
            Add Alternate Number
            <a style="background:transparent; border:none;" data-icon="camera" data-align="left" data-role="backbutton"></a>
            <a style="background:transparent; border:none;" data-icon="printer" data-align="right" data-role="button" data-click="app.callUserLogin"></a>
        </div>
    </div>

    <div>
        <form>
            <ul data-role="listview" data-style="inset">
                <li class="password" style="border-bottom:1px solid #eaeced;">
                    <input type="number" pattern="[0-9]*" step="0.01" id="editMobileAlterPage" placeholder="Mobile Number"/>
                </li>
            </ul>
            <ul  id="alternateMobile" data-role="listview" data-style="inset"></ul>
            <a style="padding-left:10px;margin-top:-10px;color:#e7613e" data-role="touch" data-bind="events: { tap: addMoreMobileNoFunc }">Add More</a>
        </form>
    </div>

    <li id="registrationNextR" class="defineSaveButton" data-role="touch" data-bind="events: { tap: editProfileFunc }">
        Save
    </li>

</div>
